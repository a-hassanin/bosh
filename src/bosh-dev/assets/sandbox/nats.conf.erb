# NATS Configuration file

listen: localhost:<%= nats_port %> # host/port to listen for client connections
# 6b9434ea-7665-4ac3-a410-e78fcd027ab4.agent.bosh-internal,O=Cloud Foundry,C=USA
log_file: "<%= nats_log_path %>"
authorization {
  users = [
    {
      user: "C=USA, O=Cloud Foundry, CN=default.director.bosh-internal"
      permissions: {
        publish: [ "agent.>", "hm.director.alert", "hm.agent.heartbeat.>", "director.>" ]
        subscribe: [ "director.>", "agent.>" ]
      }
    },
    {
      user: "C=USA, O=Cloud Foundry, CN=default.hm.bosh-internal"
      permissions: {
        publish: []
        subscribe: [
          "hm.agent.heartbeat.*",
          "hm.agent.alert.*",
          "hm.agent.shutdown.*",
          "hm.director.alert"
       ]
      }
    }
  ]
  timeout: 5
}

tls {
  cert_file: "<%= nats_certificate_paths['server']['certificate_path'] %>"
  key_file:  "<%= nats_certificate_paths['server']['private_key_path'] %>"
  ca_file:   "<%= nats_certificate_paths['ca_path'] %>"
  verify:    true
  verify_and_map: true
  timeout: 5
}
